<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign Up | WebCrawler</title>
    <link rel="stylesheet" href="/static/style.css" />
    <link rel="icon" href="/static/img/icon.png" />
  </head>
  <body>
    <!-- NAVBAR -->
    <header class="navbar">
      <div class="logo">üï∑Ô∏è <span>WebCrawler</span></div>
      <nav>
        <a href="/index.html">Home</a>
        <a href="/login.html" class="btn">Login</a>
      </nav>
    </header>

    <!-- SIGNUP FORM -->
    <section class="auth">
      <div class="auth-box">
        <h2>Create Account</h2>
        <input type="email" id="email" placeholder="Email" required />
        <input type="password" id="password" placeholder="Password" required />
        <button class="btn primary" id="confirmSignup">Sign Up</button>

        <p>
          Already have an account?
          <a href="/login.html">Login</a>
        </p>
        <div
          id="signupMessage"
          style="margin-top: 10px; color: var(--normal)"
        ></div>
      </div>
    </section>

    <footer>
      <p>¬© 2025 WebCrawler. Built by Levellers.</p>
    </footer>

    <script>
      const signupBtn = document.getElementById("confirmSignup");
      const msgDiv = document.getElementById("signupMessage");

      signupBtn.addEventListener("click", async () => {
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value.trim();

        if (!email || !password) {
          msgDiv.textContent = "‚ö†Ô∏è Please fill in all fields.";
          return;
        }

        msgDiv.textContent = "üß† Creating your account...";

        try {
          const res = await fetch("/signup", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password }),
          });

          const data = await res.json();

          if (res.ok) {
            msgDiv.textContent = "‚úÖ Account created! Redirecting to login...";
            setTimeout(() => {
              window.location.href = "/login.html";
            }, 1500);
          } else {
            msgDiv.textContent = `‚ùå ${data.error || "Unable to sign up"}`;
          }
        } catch (err) {
          msgDiv.textContent = "üö® Error connecting to server.";
        }
      });
    </script>
  </body>
</html>